<!DOCTYPE html><html lang="en"><head><title>src/lib/testers</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../"><meta name="groc-document-path" content="src/lib/testers"><meta name="groc-project-path" content="src/lib/testers.coffee"><link rel="stylesheet" type="text/css" media="all" href="../../assets/style.css"><script type="text/javascript" src="../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/lib/testers.coffee</div></div><div id="document"><div class="segment"><div class="comments"><div class="wrapper"><p>Requires</p></div></div><div class="code"><div class="wrapper"><span class="nv">pathUtil = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;path&#39;</span><span class="p">)</span>
<span class="nv">_ = underscore = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;underscore&#39;</span><span class="p">)</span>
<span class="nv">balUtil = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;bal-util&#39;</span><span class="p">)</span>
<span class="nv">joe = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;joe&#39;</span><span class="p">)</span>
<span class="nv">chai = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;chai&#39;</span><span class="p">)</span>
<span class="nv">expect = </span><span class="nx">chai</span><span class="p">.</span><span class="nx">expect</span>
<span class="nv">assert = </span><span class="nx">chai</span><span class="p">.</span><span class="nx">assert</span>
<span class="nv">request = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;request&#39;</span><span class="p">)</span>
<span class="nv">CSON = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;cson&#39;</span><span class="p">)</span>
<span class="nv">DocPad = </span><span class="nx">require</span><span class="p">(</span><span class="nx">__dirname</span><span class="o">+</span><span class="s">&#39;/docpad&#39;</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper"><span class="nv">pluginPort = </span><span class="mi">2000</span><span class="o">+</span><span class="nx">process</span><span class="p">.</span><span class="nx">pid</span>
<span class="nv">testers = </span><span class="p">{</span>
  <span class="nx">underscore</span><span class="p">,</span>
  <span class="nx">balUtil</span><span class="p">,</span>
  <span class="nx">chai</span><span class="p">,</span>
  <span class="nx">expect</span><span class="p">,</span>
  <span class="nx">assert</span><span class="p">,</span>
  <span class="nx">request</span><span class="p">,</span>
  <span class="nx">CSON</span><span class="p">,</span>
  <span class="nx">DocPad</span>
<span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Plugin Tester</p></div></div><div class="code"><div class="wrapper"><span class="nv">testers.PluginTester =</span>
<span class="k">class</span> <span class="nx">PluginTester</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Requires</p></div></div><div class="code"><div class="wrapper">  <span class="nv">chai: </span><span class="nx">chai</span>
  <span class="nv">expect: </span><span class="nx">expect</span>
  <span class="nv">assert: </span><span class="nx">assert</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Configuration</p></div></div><div class="code"><div class="wrapper">  <span class="nv">config:</span>
    <span class="nv">pluginName: </span><span class="kc">null</span>
    <span class="nv">pluginPath: </span><span class="kc">null</span>
    <span class="nv">autoExit: </span><span class="kc">true</span>
    <span class="nv">testPath: </span><span class="kc">null</span>
    <span class="nv">outExpectedPath: </span><span class="kc">null</span>
  <span class="nv">docpadConfig:</span>
    <span class="nv">port: </span><span class="kc">null</span>
    <span class="nv">growl: </span><span class="kc">false</span>
    <span class="nv">logLevel: </span><span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="s">&#39;-d&#39;</span> <span class="k">in</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">)</span> <span class="k">then</span> <span class="mi">7</span> <span class="k">else</span> <span class="mi">5</span><span class="p">)</span>
    <span class="nv">rootPath: </span><span class="kc">null</span>
    <span class="nv">outPath: </span><span class="kc">null</span>
    <span class="nv">srcPath: </span><span class="kc">null</span>
    <span class="nv">pluginPaths: </span><span class="kc">null</span>
    <span class="nv">enableUnlistedPlugins: </span><span class="kc">false</span>
    <span class="nv">enabledPlugins: </span><span class="kc">null</span>
    <span class="nv">skipUnsupportedPlugins: </span><span class="kc">false</span>
    <span class="nv">catchExceptions: </span><span class="kc">false</span>
    <span class="nv">environment: </span><span class="kc">null</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>DocPad Instance</p></div></div><div class="code"><div class="wrapper">  <span class="nv">docpad: </span><span class="kc">null</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Logger Instance</p></div></div><div class="code"><div class="wrapper">  <span class="nv">logger: </span><span class="kc">null</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Constructor</p></div></div><div class="code"><div class="wrapper">  <span class="nv">constructor: </span><span class="nf">(config={},docpadConfig={},next) -&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Apply Configuration</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span>
    <span class="vi">@config = </span><span class="nx">balUtil</span><span class="p">.</span><span class="nx">deepExtendPlainObjects</span><span class="p">({},</span> <span class="nx">PluginTester</span><span class="o">::</span><span class="nx">config</span> <span class="p">,</span><span class="nx">@config</span><span class="p">,</span> <span class="nx">config</span><span class="p">)</span>
    <span class="vi">@docpadConfig = </span><span class="nx">balUtil</span><span class="p">.</span><span class="nx">deepExtendPlainObjects</span><span class="p">({},</span> <span class="nx">PluginTester</span><span class="o">::</span><span class="nx">docpadConfig</span><span class="p">,</span> <span class="nx">@docpadConfig</span><span class="p">,</span> <span class="nx">docpadConfig</span><span class="p">)</span>
    <span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">port</span> <span class="o">?=</span> <span class="o">++</span><span class="nx">pluginPort</span>
    <span class="nx">@config</span><span class="p">.</span><span class="nx">testerName</span> <span class="o">?=</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">pluginName</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Extend Configuration</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@config</span><span class="p">.</span><span class="nx">testPath</span> <span class="o">or=</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">@config</span><span class="p">.</span><span class="nx">pluginPath</span><span class="p">,</span><span class="s">&#39;test&#39;</span><span class="p">)</span>
    <span class="nx">@config</span><span class="p">.</span><span class="nx">outExpectedPath</span> <span class="o">or=</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">@config</span><span class="p">.</span><span class="nx">testPath</span><span class="p">,</span><span class="s">&#39;out-expected&#39;</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Extend DocPad Configuration</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">rootPath</span> <span class="o">or=</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">testPath</span>
    <span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">outPath</span> <span class="o">or=</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">rootPath</span><span class="p">,</span><span class="s">&#39;out&#39;</span><span class="p">)</span>
    <span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">srcPath</span> <span class="o">or=</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">rootPath</span><span class="p">,</span><span class="s">&#39;src&#39;</span><span class="p">)</span>
    <span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">pluginPaths</span> <span class="o">?=</span> <span class="p">[</span><span class="nx">@config</span><span class="p">.</span><span class="nx">pluginPath</span><span class="p">]</span>
    <span class="nv">defaultEnabledPlugins = </span><span class="p">{}</span>
    <span class="nx">defaultEnabledPlugins</span><span class="p">[</span><span class="nx">@config</span><span class="p">.</span><span class="nx">pluginName</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">@docpadConfig</span><span class="p">.</span><span class="nx">enabledPlugins</span> <span class="o">or=</span> <span class="nx">defaultEnabledPlugins</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test API</p></div></div><div class="code"><div class="wrapper">    <span class="nx">joe</span><span class="p">.</span><span class="nx">describe</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">testerName</span><span class="p">,</span> <span class="nf">(suite,task,complete) -&gt;</span>
      <span class="nv">tester.describe = tester.suite = </span><span class="nx">suite</span>
      <span class="nv">tester.it = tester.test = </span><span class="nx">task</span>
      <span class="nv">tester.done = tester.exit = </span><span class="nx">complete</span>
      <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">tester</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create DocPad Instance</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testCreate: </span><span class="nf">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span>
    <span class="nv">docpadConfig = </span><span class="nx">@docpadConfig</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create Instance</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@test</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="nf">(done) -&gt;</span>
      <span class="nx">DocPad</span><span class="p">.</span><span class="nx">createInstance</span> <span class="nx">docpadConfig</span><span class="p">,</span> <span class="nf">(err,docpad) -&gt;</span>
        <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
        <span class="nv">tester.docpad = </span><span class="nx">docpad</span>
        <span class="nv">tester.logger = </span><span class="nx">docpad</span><span class="p">.</span><span class="nx">logger</span>
        <span class="nx">tester</span><span class="p">.</span><span class="nx">docpad</span><span class="p">.</span><span class="nx">action</span> <span class="s">&#39;clean&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
          <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
          <span class="nx">tester</span><span class="p">.</span><span class="nx">docpad</span><span class="p">.</span><span class="nx">action</span> <span class="s">&#39;install&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
            <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test Loaded</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testLoad: </span><span class="nf">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@test</span> <span class="s">&quot;load plugin </span><span class="si">#{</span><span class="nx">tester</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">pluginName</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nf">(done) -&gt;</span>
      <span class="nx">tester</span><span class="p">.</span><span class="nx">docpad</span><span class="p">.</span><span class="nx">loadedPlugin</span> <span class="nx">tester</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">pluginName</span><span class="p">,</span> <span class="nf">(err,loaded) -&gt;</span>
        <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">loaded</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">ok</span>
        <span class="k">return</span> <span class="nx">done</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Perform Server</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testServer: </span><span class="nf">(next) -&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@test</span> <span class="s">&quot;server&quot;</span><span class="p">,</span> <span class="nf">(done) -&gt;</span>
      <span class="nx">tester</span><span class="p">.</span><span class="nx">docpad</span><span class="p">.</span><span class="nx">action</span> <span class="s">&#39;server&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
        <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test Generate</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testGenerate: </span><span class="nf">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@test</span> <span class="s">&quot;generate&quot;</span><span class="p">,</span> <span class="nf">(done) -&gt;</span>
      <span class="nx">tester</span><span class="p">.</span><span class="nx">docpad</span><span class="p">.</span><span class="nx">action</span> <span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
        <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test everything</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testEverything: </span><span class="nf">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Tests</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@testCreate</span><span class="p">()</span>
    <span class="nx">@testLoad</span><span class="p">()</span>
    <span class="nx">@testGenerate</span><span class="p">()</span>
    <span class="nx">@testServer</span><span class="p">()</span>
    <span class="nx">@testCustom</span><span class="o">?</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Finish</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@finish</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Finish</p></div></div><div class="code"><div class="wrapper">  <span class="nv">finish: </span><span class="nf">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Finish</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">tester</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">autoExit</span>
      <span class="nx">@test</span> <span class="s">&#39;finish up&#39;</span><span class="p">,</span> <span class="nf">(done) -&gt;</span>
        <span class="nx">done</span><span class="p">()</span>
        <span class="nx">tester</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
        <span class="k">if</span> <span class="nx">tester</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">autoExit</span> <span class="o">isnt</span> <span class="s">&#39;safe&#39;</span>
          <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Server Tester</p></div></div><div class="code"><div class="wrapper"><span class="nv">testers.ServerTester =</span>
<span class="k">class</span> <span class="nx">ServerTester</span> <span class="k">extends</span> <span class="nx">PluginTester</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Renderer Tester</p></div></div><div class="code"><div class="wrapper"><span class="nv">testers.RendererTester =</span>
<span class="k">class</span> <span class="nx">RendererTester</span> <span class="k">extends</span> <span class="nx">PluginTester</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test Generation</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testGenerate: </span><span class="nf">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prepare</p></div></div><div class="code"><div class="wrapper">    <span class="nv">tester = </span><span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@suite</span> <span class="s">&quot;generate&quot;</span><span class="p">,</span> <span class="nf">(suite,test) -&gt;</span>
      <span class="nx">test</span> <span class="s">&#39;action&#39;</span><span class="p">,</span> <span class="nf">(done) -&gt;</span>
        <span class="nx">tester</span><span class="p">.</span><span class="nx">docpad</span><span class="p">.</span><span class="nx">action</span> <span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
          <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

      <span class="nx">test</span> <span class="s">&#39;results&#39;</span><span class="p">,</span> <span class="nf">(done) -&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get actual results</p></div></div><div class="code"><div class="wrapper">        <span class="nx">balUtil</span><span class="p">.</span><span class="nx">scantree</span> <span class="nx">tester</span><span class="p">.</span><span class="nx">docpadConfig</span><span class="p">.</span><span class="nx">outPath</span><span class="p">,</span> <span class="nf">(err,outResults) -&gt;</span>
          <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get expected results</p></div></div><div class="code"><div class="wrapper">          <span class="nx">balUtil</span><span class="p">.</span><span class="nx">scantree</span> <span class="nx">tester</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">outExpectedPath</span><span class="p">,</span> <span class="nf">(err,outExpectedResults) -&gt;</span>
            <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test results</p></div></div><div class="code"><div class="wrapper">            <span class="nx">expect</span><span class="p">(</span><span class="nx">outResults</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eql</span><span class="p">(</span><span class="nx">outExpectedResults</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Forward</p></div></div><div class="code"><div class="wrapper">            <span class="nx">done</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test a plugin
test({pluginPath: String})</p></div></div><div class="code"><div class="wrapper"><span class="nv">testers.test =</span>
<span class="nv">test = </span><span class="nf">(testerConfig, docpadConfig) -&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Configure</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testerConfig.pluginPath = </span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">testerConfig</span><span class="p">.</span><span class="nx">pluginPath</span><span class="p">)</span>
  <span class="nx">testerConfig</span><span class="p">.</span><span class="nx">pluginName</span> <span class="o">?=</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">basename</span><span class="p">(</span><span class="nx">testerConfig</span><span class="p">.</span><span class="nx">pluginPath</span><span class="p">)</span>
  <span class="nx">testerConfig</span><span class="p">.</span><span class="nx">testerPath</span> <span class="o">?=</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;out&#39;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">testerConfig</span><span class="p">.</span><span class="nx">pluginName</span><span class="si">}</span><span class="s">.tester.js&quot;</span><span class="p">)</span>
  <span class="nv">testerConfig.testerPath = </span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">testerConfig</span><span class="p">.</span><span class="nx">pluginPath</span><span class="p">,</span> <span class="nx">testerConfig</span><span class="p">.</span><span class="nx">testerPath</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Test the plugin's tester</p></div></div><div class="code"><div class="wrapper">  <span class="nv">testerClass = </span><span class="nx">require</span><span class="p">(</span><span class="nx">testerConfig</span><span class="p">.</span><span class="nx">testerPath</span><span class="p">)(</span><span class="nx">testers</span><span class="p">)</span>
  <span class="k">new</span> <span class="nx">testerClass</span> <span class="nx">testerConfig</span><span class="p">,</span> <span class="nx">docpadConfig</span><span class="p">,</span> <span class="nf">(err,testerInstance) -&gt;</span>
    <span class="k">throw</span> <span class="nx">err</span>  <span class="k">if</span> <span class="nx">err</span>
    <span class="nx">testerInstance</span><span class="p">.</span><span class="nx">testEverything</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Chain</p></div></div><div class="code"><div class="wrapper">  <span class="k">return</span> <span class="nx">testers</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Export Testers</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports = </span><span class="nx">testers</span></div></div></div></div></body></html>